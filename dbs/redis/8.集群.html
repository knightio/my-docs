<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.23" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.92" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"集群","image":["https://docs-r2.hanhan12.cc/Redis/8-1.png","https://docs-r2.hanhan12.cc/Redis/8-2.png","https://docs-r2.hanhan12.cc/Redis/8-3.png","https://docs-r2.hanhan12.cc/Redis/8-4.png","https://docs-r2.hanhan12.cc/Redis/8-5.png","https://docs-r2.hanhan12.cc/Redis/8-6.png"],"dateModified":"2025-06-10T06:31:39.000Z","author":[{"@type":"Person","name":"憨憨十二","url":"https://mister-hope.com"}]}</script><meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/dbs/redis/8.%E9%9B%86%E7%BE%A4.html"><meta property="og:site_name" content="一切为了更好的自己"><meta property="og:title" content="集群"><meta property="og:description" content="8.集群 定义 定义：由于数据量过大，单个Master复制集难以承担，因此需要对多个复制集进行集群，形成水平扩展每个复制集只负责存储整个数据集 的一部分，这就是Redis的集群，其作用是提供在多个Redis节点间共享数据的程序集。 Redis集群是一个提供在多个Redis节点间共享数据的程序集，Redis集群可以支持多个master 作用 Redis集..."><meta property="og:type" content="article"><meta property="og:image" content="https://docs-r2.hanhan12.cc/Redis/8-1.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-06-10T06:31:39.000Z"><meta property="article:modified_time" content="2025-06-10T06:31:39.000Z"><title>集群 | 一切为了更好的自己</title><meta name="description" content="8.集群 定义 定义：由于数据量过大，单个Master复制集难以承担，因此需要对多个复制集进行集群，形成水平扩展每个复制集只负责存储整个数据集 的一部分，这就是Redis的集群，其作用是提供在多个Redis节点间共享数据的程序集。 Redis集群是一个提供在多个Redis节点间共享数据的程序集，Redis集群可以支持多个master 作用 Redis集...">
    <link rel="preload" href="/assets/style-CXpIAhLQ.css" as="style"><link rel="stylesheet" href="/assets/style-CXpIAhLQ.css">
    <link rel="modulepreload" href="/assets/app-CuAYvg6V.js"><link rel="modulepreload" href="/assets/8.集群.html-CrBshbxS.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-DrgqT5zc.js" as="script"><link rel="prefetch" href="/assets/portfolio.html-CkhTl4Ll.js" as="script"><link rel="prefetch" href="/assets/index.html-Ddgi8Ea0.js" as="script"><link rel="prefetch" href="/assets/index.html-KaUbC-h7.js" as="script"><link rel="prefetch" href="/assets/2023.html-B_ksWbGu.js" as="script"><link rel="prefetch" href="/assets/index.html-BhZ42LO-.js" as="script"><link rel="prefetch" href="/assets/index.html-DnE-wSAV.js" as="script"><link rel="prefetch" href="/assets/index.html-BDSr6Tt-.js" as="script"><link rel="prefetch" href="/assets/index.html-DYS0i0JW.js" as="script"><link rel="prefetch" href="/assets/portfolio.html-D5K-IRQQ.js" as="script"><link rel="prefetch" href="/assets/index.html-pSydzuDY.js" as="script"><link rel="prefetch" href="/assets/10.前端编译与优化.html-DNzrgPSS.js" as="script"><link rel="prefetch" href="/assets/11.后端编译与优化.html-CCxApF77.js" as="script"><link rel="prefetch" href="/assets/2.Java内存区域与内存溢出异常.html-DaU9XPDd.js" as="script"><link rel="prefetch" href="/assets/3.垃圾收集器与内存分配策略（上）.html-BO62aIC7.js" as="script"><link rel="prefetch" href="/assets/3.垃圾收集器与内存分配策略（下）.html-DlfZnpIY.js" as="script"><link rel="prefetch" href="/assets/4.虚拟机性能监控、故障处理工具.html-4CgKRPgo.js" as="script"><link rel="prefetch" href="/assets/5.调优案例分析与实战.html-sGvkDKVl.js" as="script"><link rel="prefetch" href="/assets/6.类文件结构（上）.html-BZLNEyEn.js" as="script"><link rel="prefetch" href="/assets/6.类文件结构（下）.html-BG0TKTCN.js" as="script"><link rel="prefetch" href="/assets/7.虚拟机类加载机制.html-COsIdw_p.js" as="script"><link rel="prefetch" href="/assets/8.虚拟机字节码执行引擎.html-CcTh4xuF.js" as="script"><link rel="prefetch" href="/assets/9.类加载及执行子系统的案例与实战.html-BcWeJDlR.js" as="script"><link rel="prefetch" href="/assets/index.html-DoakugG8.js" as="script"><link rel="prefetch" href="/assets/index.html-DTXmAD9x.js" as="script"><link rel="prefetch" href="/assets/baz.html-W5CTw5WQ.js" as="script"><link rel="prefetch" href="/assets/index.html-TagrfsnR.js" as="script"><link rel="prefetch" href="/assets/ray.html-CI4vzVy7.js" as="script"><link rel="prefetch" href="/assets/basis.html-BmRSgtRs.js" as="script"><link rel="prefetch" href="/assets/dump.html-bmD57Tsr.js" as="script"><link rel="prefetch" href="/assets/logs.html-BWfblU-v.js" as="script"><link rel="prefetch" href="/assets/0.redis7.html-BX3MWSQ7.js" as="script"><link rel="prefetch" href="/assets/1.十大数据类型.html-z8PHIuoi.js" as="script"><link rel="prefetch" href="/assets/2.持久化.html-D48tsUBT.js" as="script"><link rel="prefetch" href="/assets/3.事务.html-BMOrpLgc.js" as="script"><link rel="prefetch" href="/assets/4.管道.html-DUiOnjZD.js" as="script"><link rel="prefetch" href="/assets/5.发布与订阅.html-DLdUzpOl.js" as="script"><link rel="prefetch" href="/assets/6.复制.html-BOSb0Nuo.js" as="script"><link rel="prefetch" href="/assets/7.哨兵.html-B3z0FpTc.js" as="script"><link rel="prefetch" href="/assets/index.html-b4A_BTvP.js" as="script"><link rel="prefetch" href="/assets/index.html-BPmowo0T.js" as="script"><link rel="prefetch" href="/assets/index.html-B-opzSNJ.js" as="script"><link rel="prefetch" href="/assets/basis.html-7rWqlEjc.js" as="script"><link rel="prefetch" href="/assets/no.html-D4jTEUK9.js" as="script"><link rel="prefetch" href="/assets/index.html-BklyabeD.js" as="script"><link rel="prefetch" href="/assets/basis.html-BPm9K7d9.js" as="script"><link rel="prefetch" href="/assets/index.html-D7KZASTE.js" as="script"><link rel="prefetch" href="/assets/basis.html-BUd82M1R.js" as="script"><link rel="prefetch" href="/assets/index.html-Bpeyp0Vd.js" as="script"><link rel="prefetch" href="/assets/SpringSecurity.html-ClzzZCQw.js" as="script"><link rel="prefetch" href="/assets/demo.html-Cz8oM-xM.js" as="script"><link rel="prefetch" href="/assets/index.html-BNNuZWYa.js" as="script"><link rel="prefetch" href="/assets/basis.html-_qAdJyqD.js" as="script"><link rel="prefetch" href="/assets/index.html-DKhq5O3I.js" as="script"><link rel="prefetch" href="/assets/index.html-C7BP2XPV.js" as="script"><link rel="prefetch" href="/assets/string-compression.html-Cyyk22FZ.js" as="script"><link rel="prefetch" href="/assets/index.html-VBhqKB9t.js" as="script"><link rel="prefetch" href="/assets/install.html-IN65K1fu.js" as="script"><link rel="prefetch" href="/assets/index.html-3lJZ5stZ.js" as="script"><link rel="prefetch" href="/assets/basis.html-Cau-YPQ3.js" as="script"><link rel="prefetch" href="/assets/index.html-B6W4J1Ge.js" as="script"><link rel="prefetch" href="/assets/arthas.html-YTDnuMye.js" as="script"><link rel="prefetch" href="/assets/basis.html-B8N8H5jf.js" as="script"><link rel="prefetch" href="/assets/crontab.html-abfLsEPY.js" as="script"><link rel="prefetch" href="/assets/drone.html-DHHkzXKE.js" as="script"><link rel="prefetch" href="/assets/firewall.html-DXS6Udd8.js" as="script"><link rel="prefetch" href="/assets/nginx.html-CugLgPgv.js" as="script"><link rel="prefetch" href="/assets/podman-compose.html-PBdHoGIY.js" as="script"><link rel="prefetch" href="/assets/podman.html-COX4rO8I.js" as="script"><link rel="prefetch" href="/assets/index.html-5GxmO3wd.js" as="script"><link rel="prefetch" href="/assets/disable.html-BpIquoU-.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-ENc6TvYj.js" as="script"><link rel="prefetch" href="/assets/layout.html-CcC8K6wY.js" as="script"><link rel="prefetch" href="/assets/markdown.html-CI0M_CVJ.js" as="script"><link rel="prefetch" href="/assets/page.html-C815PfWr.js" as="script"><link rel="prefetch" href="/assets/index.html-DNci1SsR.js" as="script"><link rel="prefetch" href="/assets/basis.html-CaAIqOmr.js" as="script"><link rel="prefetch" href="/assets/basis.html-CZ6Xw0kk.js" as="script"><link rel="prefetch" href="/assets/basis.html-BAm0ujNF.js" as="script"><link rel="prefetch" href="/assets/basis.html-BuZ5Hwnq.js" as="script"><link rel="prefetch" href="/assets/index.html-D7G_9iCB.js" as="script"><link rel="prefetch" href="/assets/baz.html-lFAPV4sv.js" as="script"><link rel="prefetch" href="/assets/index.html-BDAvAfs2.js" as="script"><link rel="prefetch" href="/assets/ray.html-Ckpg5XWt.js" as="script"><link rel="prefetch" href="/assets/404.html-DKAjIPDB.js" as="script"><link rel="prefetch" href="/assets/index.html-Ce27aIb4.js" as="script"><link rel="prefetch" href="/assets/index.html-BOR4gh8w.js" as="script"><link rel="prefetch" href="/assets/index.html-BQJyQM0G.js" as="script"><link rel="prefetch" href="/assets/index.html-lb23LAJ3.js" as="script"><link rel="prefetch" href="/assets/index.html-Cbntx4WQ.js" as="script"><link rel="prefetch" href="/assets/index.html-DhpyZwDP.js" as="script"><link rel="prefetch" href="/assets/index.html-CQyhOe7a.js" as="script"><link rel="prefetch" href="/assets/index.html-D9vhFvhC.js" as="script"><link rel="prefetch" href="/assets/index.html-DwEU5S5l.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-D2Nf-uDI.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">一切为了更好的自己</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="主页"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lightbulb" sizing="height" height="1em"></iconify-icon><!--]-->主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/java/" aria-label="Java"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lightbulb" sizing="height" height="1em"></iconify-icon><!--]-->Java<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/books/" aria-label="Books"><!---->Books<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/dbs/" aria-label="数据库"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lightbulb" sizing="height" height="1em"></iconify-icon><!--]-->数据库<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/linux/" aria-label="Linux"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lightbulb" sizing="height" height="1em"></iconify-icon><!--]-->Linux<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/interview/" aria-label="面试"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lightbulb" sizing="height" height="1em"></iconify-icon><!--]-->面试<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="LeetCode"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lightbulb" sizing="height" height="1em"></iconify-icon>LeetCode<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/leetcode/daily/" aria-label="Daily"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lightbulb" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Daily<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/leetcode/leetcode-75/" aria-label="Leetcode-75"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lightbulb" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Leetcode-75<!----></a></li></ul></button></div></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Elasticsearch</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Mysql</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Redis</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/dbs/redis/0.redis7.html" aria-label="开始"><!---->开始<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/dbs/redis/1.%E5%8D%81%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html" aria-label="十大数据类型"><!---->十大数据类型<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/dbs/redis/2.%E6%8C%81%E4%B9%85%E5%8C%96.html" aria-label="持久化"><!---->持久化<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/dbs/redis/3.%E4%BA%8B%E5%8A%A1.html" aria-label="事务"><!---->事务<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/dbs/redis/4.%E7%AE%A1%E9%81%93.html" aria-label="管道"><!---->管道<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/dbs/redis/5.%E5%8F%91%E5%B8%83%E4%B8%8E%E8%AE%A2%E9%98%85.html" aria-label="发布与订阅"><!---->发布与订阅<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/dbs/redis/6.%E5%A4%8D%E5%88%B6.html" aria-label="复制"><!---->复制<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/dbs/redis/7.%E5%93%A8%E5%85%B5.html" aria-label="哨兵"><!---->哨兵<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/dbs/redis/8.%E9%9B%86%E7%BE%A4.html" aria-label="集群"><!---->集群<!----></a></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->集群</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mister-hope.com" target="_blank" rel="noopener noreferrer">憨憨十二</a></span><span property="author" content="憨憨十二"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025/6/10</span><meta property="datePublished" content="2025-06-10T05:57:39.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 14 分钟</span><meta property="timeRequired" content="PT14M"></span><!----><!----></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="_8-集群" tabindex="-1"><a class="header-anchor" href="#_8-集群"><span>8.集群</span></a></h1><h2 id="定义" tabindex="-1"><a class="header-anchor" href="#定义"><span>定义</span></a></h2><p>定义：由于数据量过大，单个Master复制集难以承担，因此需要对多个复制集进行集群，形成水平扩展每个复制集只负责存储整个数据集 的一部分，这就是Redis的集群，其作用是提供在多个Redis节点间共享数据的程序集。</p><p>Redis集群是一个提供在多个Redis节点间共享数据的程序集，Redis集群可以支持多个master</p><h2 id="作用" tabindex="-1"><a class="header-anchor" href="#作用"><span>作用</span></a></h2><ul><li>Redis集群支持多个master，每个master又可以挂载多个slave <ol><li>读写分离</li><li>支持数据的高可用</li><li>支持海量数据的读写存储操作</li></ol></li><li>由于Cluster自带Sentinel的故障转移机制，内置了高可用的支持，$\textcolor{red}{\large 无需再去使用哨兵功能}$</li><li>客户端与Redis的节点连接，不再需要连接集群中所有的节点，只需要任意连接集群中的一个可用节点即可</li><li>$\textcolor{red}{槽位slot负责分配到各个物理服务节点，由对应的集群来负责维护节点、插槽和数据之间的关系}$</li></ul><h2 id="集群算法-分片-槽位slot" tabindex="-1"><a class="header-anchor" href="#集群算法-分片-槽位slot"><span>集群算法-分片-槽位slot</span></a></h2><p><a href="https://redis.io/docs/latest/operate/oss_and_stack/reference/cluster-spec/#key-distribution-model" target="_blank" rel="noopener noreferrer">官方文档</a></p><blockquote><p>Key distribution model</p><p>The cluster&#39;s key space is split into 16384 slots, effectively setting an upper limit for the cluster size of 16384 master nodes (however, the suggested max size of nodes is on the order of ~ 1000 nodes).</p><p>Each master node in a cluster handles a subset of the 16384 hash slots. The cluster is stable when there is no cluster reconfiguration in progress (i.e. where hash slots are being moved from one node to another). When the cluster is stable, a single hash slot will be served by a single node (however the serving node can have one or more replicas that will replace it in the case of net splits or failures, and that can be used in order to scale read operations where reading stale data is acceptable).</p><p>The base algorithm used to map keys to hash slots is the following (read the next paragraph for the hash tag exception to this rule):</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>HASH_SLOT = CRC16(key) mod 16384</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></blockquote><h3 id="槽位slot" tabindex="-1"><a class="header-anchor" href="#槽位slot"><span>槽位slot</span></a></h3><p>Redis集群的数据分片</p><p>Redis集群没有使用一致性hash 而是引入了哈希槽的概念。</p><p>Redis集群有16384个哈希槽每个key通过CRC16校验后对16384取模来决定放置哪个槽，集群的每个节点负责一部分hash槽</p><h3 id="redis集群的分片" tabindex="-1"><a class="header-anchor" href="#redis集群的分片"><span>redis集群的分片</span></a></h3><ul><li><p>分片是什么</p><p>使用Redis集群时我们会将存储的数据分散到多台redis机器上，这称为分片。简言之，集群中的每个Redis实例都被认为是整个数据的一个分片。</p></li><li><p>如何找到给定key的分片</p><p>为了找到给定key的分片，我们对key进行CRC16(key)算法处理并通过对总分片数量取模。然后，$\textcolor{red}{\large使用确定性哈希函数}$，这意味着给定的key$\textcolor{red}{\large将多次始终映射到同一个分片}$，我们可以推断将来读取特定key的位置。</p></li></ul><h3 id="分片和槽位的优势" tabindex="-1"><a class="header-anchor" href="#分片和槽位的优势"><span>分片和槽位的优势</span></a></h3><p>$\textcolor{yellow}{最大优势，方便扩缩容和数据分派查找}$</p><p>这种结构很容易添加或者删除节点，比如如果我想添加个节点D，我需要从节点A，B，C中得部分槽位到D上。如果我想一出节点A，需要将A中的槽移动到B和C节点上，然后将没有任何槽的节点从集群中移除即可。由于一个结点将哈希槽移动到另一个节点不会停止服务，所以无论添加删除或者改变某个节点的哈希槽的数量都不会造成集群不可用的状态。</p><h2 id="slot槽位映射方案" tabindex="-1"><a class="header-anchor" href="#slot槽位映射方案"><span>slot槽位映射方案</span></a></h2><h3 id="slot槽位映射-一般业界有三种解决方案" tabindex="-1"><a class="header-anchor" href="#slot槽位映射-一般业界有三种解决方案"><span>slot槽位映射，一般业界有三种解决方案</span></a></h3><ol><li><p>哈希取余分区(小厂)</p><p>2亿条记录就是2亿个k,v，我们单机不行必须要分布式多机，假设有3台机器构成一个集群，用户每次读写操作都是根据公式：hash(key) % N个机器台数，计算出哈希值，用来决定数据映射到哪一个节点上。</p><p>$\textcolor{blue}{\large 优点}$：简单粗暴，直接有效，只需要预估好数据规划好节点，例如3台、8台、10台，就能保证一段时间的数据 支撑。使用Hash算法让固定的一部分请求落到同一台服务器上，这样每台服务器固定处理一部分请求 (并维护这些请求的信息)， 起到负载均衡+分而治之的作用。</p><p>$\textcolor{blue}{\large 缺点}$：原来规划好的节点，进行扩容或者缩容就比较麻烦了额，不管扩缩，每次数据变动导致节点有变动，映射关系需要重新进行计算，在服务器个数固定不变时没有问题，如果需要弹性扩容或故障停机的情况下，原来的取模公式就会发生变化: Hash(key)/3会 变成Hash(key) /?。此时地址经过取余运算的结果将发生很大变化，根据公式获取的服务器也会变得不可控。<br> 某个redis机器宕机了，由于台数数量变化，会导致hash取余全部数据重新洗牌。</p></li><li><p>一致性哈希算法分区(中厂)</p><ul><li><p>是什么？</p><p>一致性Hash算法背景是在1997年由麻省理工学院提出的，设计目标是<strong>为了解决分布式缓存数据变动和映射问题</strong>，某个机器宕机了，分母数量改变了，自然取余数不行了</p></li><li><p>能干嘛？</p><p>提出一致性Hash解决方案。目的是当服务器个数发生变动时，尽量减少影响客户端到服务器的映射关系</p></li><li><p>3大步骤</p><p>$\textcolor{blue}{\large 算法构建一致性哈希环}$</p><p>一致性哈希算法必然有个hash函数并按照算法产生hash值，这个算法的所有可能哈希值会构成一个全量集，这个集合可以成为一个hash空间[0,2^32-1]，这个是一个线性空间，但是在算法中，我们通过适当的逻辑控制将它首尾相连(O= 2^32),这样让它逻辑上形成了一个环形空间。<br> 它也是按照使用取模的方法，<strong>前面笔记介绍的节点取模法是对节点（服务器）的数量进行取模。而一致性Hash算法是对2<sup>32取模，简单来说，一致性Hash算法将整个哈希值空间组织成一个虚拟的圆环**，如假设某哈希函数H的值空间为0-2</sup>32-1(即哈希值是一个32位无符号整形），整个哈希环如下图:整个空间</strong>按顺时针方向组织**，圆环的正上方的点代表0，O点右侧的第一个点代表1，以此类推，2、3、4、……直到2<sup>32-1，也就是说0点左侧的第一个点代表2</sup>32-1，0和2个32-1在零点中方向重合，我们把这个由2^32个点组成的圆环称为Hash环。</p><figure><img src="https://docs-r2.hanhan12.cc/Redis/8-1.png" alt="Hash环" tabindex="0" loading="lazy"><figcaption>Hash环</figcaption></figure><p>$\textcolor{blue}{\large 服务器IP节点映射}$</p><p>将集群中各个IP节点映射到环上的某一个位置。<br> 将各个服务器使用Hash进行一个哈希，具体可以选择服务器的IP或主机名作为关键字进行哈希，这样每台机器就能确定其在哈希环上的位置。假如4个节点NodeA、B、C、D，经过IP地址的<strong>哈希函数</strong>计算(hash(ip))，使用IP地址哈希后在环空间的位置如下:</p><figure><img src="https://docs-r2.hanhan12.cc/Redis/8-2.png" alt="对节点取Hash值" tabindex="0" loading="lazy"><figcaption>对节点取Hash值</figcaption></figure><p>$\textcolor{blue}{\large key落到服务器的落键规则}$</p><p>当我们需要存储一个kv键值对时，首先计算key的hash值，hash(key)，将这个key使用相同的函数Hash计算出哈希值并确定此数据在环上的位置，<strong>从此位置沿环顺时针“行走”</strong>，第一台遇到的服务器就是其应该定位到的服务器，并将该键值对存储在该节点上。<br> 如我们有Object A、 Object B、 Object C. object D四个数据对象，经过哈希计算后，在环空间上的位置如下:根据一致性Hash算法，数据A会被定为到Node A上，B被定为到Node B上，C被定为到Node C上，D被定为到Node D上。</p><figure><img src="https://docs-r2.hanhan12.cc/Redis/8-3.png" alt="key的落键规则" tabindex="0" loading="lazy"><figcaption>key的落键规则</figcaption></figure></li><li><p>优点</p><p>$\textcolor{green}{\large 一致性哈希算法的容错性}$ ：假设Node C宕机，可以看到此时对象A、B、D不会受到影响。一般的，在一致性Hash算法中，如果一台服务器不可用，则受影响的数据仅仅是此服务器到其环空间中前一台服务悉**〈即沿着逆时针方向行走遇到的第一台服务器）之间数据**，其它不会受到影响。简单说，就是C挂了，受到影响的只是B、C之间的数据<strong>且这些数据会转移到D进行存储</strong>。</p></li></ul><figure><img src="https://docs-r2.hanhan12.cc/Redis/8-4.png" alt="一致性哈希算法容错性" tabindex="0" loading="lazy"><figcaption>一致性哈希算法容错性</figcaption></figure><p>$\textcolor{green}{\large 一致性哈希算法的扩展性}$</p><p>数据量增加了，需要增加一台节点NodeX，X的位置在A和B之间，那收到影响的也就是A到X之间的数据，重新把A到X的数据录入到X上即可，不会导致hash取余全部数据重新洗牌。</p><figure><img src="https://docs-r2.hanhan12.cc/Redis/8-5.png" alt="一致性哈希算法扩展性" tabindex="0" loading="lazy"><figcaption>一致性哈希算法扩展性</figcaption></figure><ul><li><p>缺点</p><p>$\textcolor{green}{\large 一致性哈希算法的数据倾斜问题}$</p><p>一致性Hash算法在服务<strong>节点太少时</strong>，容易因为节点分布不均匀而造成<strong>数据倾斜</strong>（被缓存的对象大部分集中缓存在某一台服务器上)问题，例如系统中只有两台服务器:</p><figure><img src="https://docs-r2.hanhan12.cc/Redis/8-6.png" alt="一致性哈希算法缺点" tabindex="0" loading="lazy"><figcaption>一致性哈希算法缺点</figcaption></figure></li><li><p>小总结</p><p>为了在节点数目发生改变时尽可能少的迁移数据</p><p>将所有的存储节点排列在收尾相接的Hash环上，每个key在计算Hash后会顺时针找到临近的存储节点存放。而当有节点加入或退出时仅影响该节点在Hash环上顺时针相邻的后续节点。</p><p>$\textcolor{green}{\large 优点}$ ：加入和删除节点只影响哈希环中顺时针方向的相邻的节点，对其他节点无影响。</p><p>$\textcolor{green}{\large 缺点}$ ：数据的分布和节点的位置有关，因为这些节点不是均匀的分布在哈希环上的，所以数据在进行存储时达不到均匀分布的效果。</p></li></ul></li><li><p>$\textcolor{red}{\large 哈希槽分区}$(大厂)</p><ul><li><p>是什么？ HASH_SLOT = CRC16(key) mod 16384</p><ol><li><p>为什么出现</p><p>哈希槽实质就是一个数组，数组[0, 2^14 - 1]形成hash slot空间</p></li><li><p>能干什么</p><p>解决均匀分配的问题，在$\textcolor{red}{\large 数据和节点之间又加入了一层，把这层称为哈希槽(slot)，用于管理数据和节点之间的关系}$，现在就相当于节点上放的是槽，槽里面放的是数据。</p><p>槽解决的是粒度问题，相当于把粒度变大了，这样便于数据移动。哈希解决的是映射问题，使用key的哈希值来计算所在的槽，便于数据分配</p></li><li><p>多少个hash</p><p>一个集群只能有16384个槽，编号0-16383(0-2^14-1)。这些槽会分配给集群中的所有主节点，分配策略没有要求。</p><p>集群会记录节点和槽的对应关系，解决了节点和槽的关系后，接下来就需要对key求哈希值，然后对16384取模，余数是几key就落入对应的槽里。HASH_SLOT = CRC16(key) mod 16384。以槽为单位移动数据，因为槽的数目是固定的，处理起来比较容易，这样数据移动问题就解决了。</p></li></ol></li><li><p>哈希槽计算</p><p>Redis集群中内置了16384个哈希槽，redis 会根据节点数量大致均等的将哈希槽映射到不同的节点。当需要在Redis集群中放置一个key-valuel时，redis先对key使用crc16算法算出一个结果然后用结果对16384求余数[ CRC16(key) % 16384]，这样每个key都会对应一个编号在0-16383之间的哈希槽，也就是映射到某个节点上。如下代码，key之A、B在Node2， key之C落在Node3上</p></li></ul><h3 id="textcolor-red-large-经典面试题-为什么redis集群的最大槽数是16384个" tabindex="-1"><a class="header-anchor" href="#textcolor-red-large-经典面试题-为什么redis集群的最大槽数是16384个"><span>$\textcolor{red}{\large 经典面试题：为什么Redis集群的最大槽数是16384个？}$</span></a></h3><p>Redis集群并没有使用一致性hash而是引入了哈希槽的概念。Redis 集群有16384个哈希糟，每个key通过CRC16校验后对16384取模来决定放置哪个槽，集群的每个节点负责一部分hash槽。但为什么哈希槽的数量是16384 (2^14）个呢？</p><p>CRC16算法产生的hash值有16bit，该算法可以产生2^16=65536个值。<br> 换句话说值是分布在0～65535之间，有更大的65536不用为什么只用16384就够?</p><p>作者在做mod运算的时候，为什么不mod65536，而选择mod16384? $\textcolor{blue}{\large HASH_SLOT = CRC16(key) mod 65536为什么没启用？}$</p><p>作者回答：<a href="https://github.com/redis/redis/issues/2576" target="_blank" rel="noopener noreferrer">https://github.com/redis/redis/issues/2576</a></p><p>说明1：</p><p>正常的心跳数据包带有节点的完整配置，可以用幂等方式用旧的节点替换旧节点，以便更新旧的配置。<br> 这意味着它们包含原始节点的插槽配置，该节点使用2k的空间和16k的插槽，但是会使用8k的空间（使用65k的插槽）。同时，由于其他设计折衷，Redis集群不太可能扩展到1000个以上的主节点。<br> 因此16k处于正确的范围内，以确保每个主机具有足够的插槽，最多可容纳1000个矩阵，但数量足够少，可以轻松地将插槽配置作为原始位图传播。请注意，在小型群集中，位图将难以压缩，因为当N较小时，位图将设置的slot / N位占设置位的很大百分比。</p><p>说明2：</p><p>$\textcolor{blue}{\large (1)如果槽位为65536，发送心跳信息的消息头达8k，发送的心跳包过于庞大。}$<br> 在消息头中最占空间的是myslots[CLUSTER_SLOTS/8]。当槽位为65536时，这块的大小是:65536÷8÷1024=8kb</p><p>在消息头中最占空间的是myslots[CLUSTER_SLOTS/8]。当槽位为16384时，这块的大小是:16384∶8∶1024=2kb</p><p>因为每秒钟，redis节点需要发送一定数量的ping消息作为心跳包，如果槽位为65536，这个ping消息的消息头太大了，浪费带宽。<br> $\textcolor{blue}{\large (2)redis的集群主节点数量基本不可能超过1000个。}$<br> 集群节点越多，心跳包的消息体内携带的数据越多。如果节点过1000个，也会导致网络拥堵。因此redis作者不建议redis cluster节点数量超过1000个。那么，对于节点数在1000以内的redis cluster集群，16384个槽位够用了。没有必要拓展到65536个。<br> $\textcolor{blue}{\large (3)槽位越小，节点少的情况下，压缩比高，容易传输}$<br> Redis主节点的配置信息中它所负责的哈希槽是通过一张bitmap的形式来保存的，在传输过程中会对bitmap进行压缩，但是如果bitmap的填充率slots /N很高的话(N表示节点数)， bitmap的压缩率就很低。如果节点数很少，而哈希槽数量很多的话，bitmap的压缩率就很低。</p><p>计算结论</p><p>Redis集群中内置了16384个哈希槽，redis会根据节点数量大致均等的将哈希槽映射到不同的节点。当需要在Redis集群中放置-一个key-value时， redis先对key使用crc16算法算出一个结果然后用结果对16384求余数[ CRC16(key) % 16384]， 这样每个key都会对应一个编号在0-16383之间的哈希槽，也就是映射到某个节点上。如下代码，key之A、B在Node2， key之C落在Node3上</p></li></ol><h3 id="redis集群不保证强一致性" tabindex="-1"><a class="header-anchor" href="#redis集群不保证强一致性"><span>Redis集群不保证强一致性</span></a></h3><p>redis集群$\textcolor{blue}{\large 不保证强一致性}$，这意味着在特定的条件下，Redis集群可能会丢掉一些被系统收到的写入请求命令</p></div><!----><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/dbs/redis/8.集群.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">最近更新：</span><time class="vp-meta-info" datetime="2025-06-10T06:31:39.000Z" data-allow-mismatch>2025/6/10 06:31</time></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: wangkai@consen.net">consen3464</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/dbs/redis/7.%E5%93%A8%E5%85%B5.html" aria-label="哨兵"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->哨兵</div></a><!----></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">Default footer</div><div class="vp-copyright">Copyright © 2025 憨憨十二 </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CuAYvg6V.js" defer></script>
  </body>
</html>
